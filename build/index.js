(()=>{"use strict";const e=window.wp.blocks,o=window.wp.i18n,r=window.wp.blockEditor,n=window.wp.element,t=window.wp.components,s=window.ReactJSXRuntime;function l(e){if(!e)return"";let o=null,r=e;const n=document.createElement("textarea");for(let e=0;e<6&&(n.innerHTML=r,r=n.value,r!==o);e++)o=r;return r=r.replace(/&[#A-Za-z0-9]+;/g,""),r=r.replace(/[\u2010-\u2015\u2212\u2012]/g,"-"),r}function i(e){if(!e||isNaN(e))return null;const r=[],n=Math.round(2*e)/2;for(let e=1;e<=5;e++)n>=e?r.push("★"):r.push("☆");return(0,s.jsx)("span",{style:{color:"#ffc844",fontSize:"1.08rem",letterSpacing:"0.05em",marginRight:6},"aria-label":(0,o.__)("Star rating","wp-org-portfolio-block-wp"),children:r.join("")})}function a(){return(0,s.jsxs)(t.PanelBody,{title:(0,o.__)("Powered by Telex","wp-org-portfolio-block-wp"),initialOpen:!0,children:[(0,s.jsx)("p",{children:"Telex is basically the J.A.R.V.I.S of WordPress development - an AI that builds blocks so you don't have to."}),(0,s.jsx)("p",{style:{marginTop:6},children:(0,s.jsx)("a",{href:"https://telex.automattic.ai",target:"_blank",rel:"noopener noreferrer",children:"Learn more about Telex"})})]})}const c=JSON.parse('{"UU":"w0/wp-org-portfolio"}');(0,e.registerBlockType)(c.UU,{edit:function({attributes:e,setAttributes:c}){const{username:d,showType:p="plugins",perPage:u=10,align:g,loadedCount:h}=e,[w,m]=(0,n.useState)(!1),[x,f]=(0,n.useState)([]),[b,j]=(0,n.useState)([]),[_,k]=(0,n.useState)("");(0,n.useEffect)(()=>{d?((async e=>{if(!e)return f([]),j([]),void k("");m(!0),k("");try{const r=await wp.apiFetch({path:`/wporg-showcase/v1/author/${encodeURIComponent(e)}`});let n=r.plugins||[],t=r.themes||[];Array.isArray(n)||(n=[]),Array.isArray(t)||(t=[]),f(n),j(t),0===n.length&&0===t.length?k((0,o.__)("No results found for this username.","wp-org-portfolio-block-wp")):k("")}catch(e){k((0,o.__)("Failed to fetch data.","wp-org-portfolio-block-wp")),f([]),j([])}m(!1)})(d),c({...e,loadedCount:void 0})):(f([]),j([]),k(""))},[d]);const v=(0,r.useBlockProps)({className:g?`align${g}`:void 0});function y(o,r){const n=Number(h)||u,t=Math.min(n+u,r);c({...e,loadedCount:t})}return(0,s.jsxs)("div",{...v,children:[(0,s.jsx)(r.BlockControls,{children:(0,s.jsx)(r.AlignmentControl,{value:g,onChange:e=>c({align:e})})}),(0,s.jsxs)(r.InspectorControls,{children:[(0,s.jsxs)(t.PanelBody,{title:(0,o.__)("WP.org Author Settings","wp-org-portfolio-block-wp"),initialOpen:!0,children:[(0,s.jsx)(t.TextControl,{label:(0,o.__)("Username","wp-org-portfolio-block-wp"),value:d,onChange:e=>c({username:e,loadedCount:void 0}),placeholder:(0,o.__)("e.g. automattic","wp-org-portfolio-block-wp")}),(0,s.jsx)(t.SelectControl,{label:(0,o.__)("Show","wp-org-portfolio-block-wp"),value:p,options:[{label:(0,o.__)("Plugins","wp-org-portfolio-block-wp"),value:"plugins"},{label:(0,o.__)("Themes","wp-org-portfolio-block-wp"),value:"themes"}],onChange:e=>c({showType:e,loadedCount:void 0})}),(0,s.jsx)(t.TextControl,{label:(0,o.__)("Items per click","wp-org-portfolio-block-wp"),type:"number",min:"1",max:"50",value:u,onChange:e=>c({perPage:Math.max(1,Math.min(50,parseInt(e)||1)),loadedCount:void 0})})]}),(0,s.jsx)(a,{})]}),(0,s.jsx)("div",{children:d?w?(0,s.jsx)(t.Spinner,{}):_?(0,s.jsx)(t.Notice,{status:"error",children:_}):(0,s.jsxs)("div",{children:["plugins"===p&&(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:(0,o.__)("Plugins","wp-org-portfolio-block-wp")}),function(){if(!x.length)return(0,s.jsx)("div",{children:(0,o.__)("No plugins found.","wp-org-portfolio-block-wp")});const e=Number(h)||u,r=x.slice(0,e);return(0,s.jsxs)("div",{className:"was-grid",children:[r.map(e=>{const r=e.icons&&e.icons["1x"]?e.icons["1x"]:e.icons&&e.icons.default?e.icons.default:"",n=e.rating&&e.num_ratings?Number(e.rating):null,a=n?n/20:null,c=l(e.name),d=l(e.short_description),p=`https://wordpress.org/plugins/${e.slug}/`;return(0,s.jsxs)("div",{className:"was-card",children:[r&&(0,s.jsx)("img",{src:r,alt:c}),(0,s.jsxs)("div",{className:"was-card-content",children:[(0,s.jsx)("a",{href:p,target:"_blank",rel:"noopener noreferrer",children:c}),a&&(0,s.jsxs)("div",{className:"was-rating",children:[i(a),(0,s.jsxs)("span",{className:"was-rating-numeric",children:[a.toFixed(1)," / 5"]}),(0,s.jsxs)("span",{className:"was-num-ratings",children:["(",e.num_ratings," ratings)"]})]}),d&&(0,s.jsx)("p",{children:d}),e.active_installs&&(0,s.jsxs)("div",{className:"was-meta",children:[e.active_installs.toLocaleString(),"+ installs"]}),(0,s.jsx)(t.Button,{onClick:()=>window.open(p,"_blank"),className:"was-learn-more",tabIndex:0,children:(0,o.__)("Learn more","wp-org-portfolio-block-wp")})]})]},e.slug)}),r.length<x.length&&(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,s.jsx)(t.Button,{className:"was-load-more-btn",style:{margin:"0 0 8px 0",padding:"5px 20px",fontSize:"1em",borderRadius:4,background:"#f3f3f6",border:"1px solid #bbb",color:"#222",cursor:"pointer"},onClick:()=>y(0,x.length),children:(0,o.__)("Load more","wp-org-portfolio-block-wp")})})]})}()]}),"themes"===p&&(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:(0,o.__)("Themes","wp-org-portfolio-block-wp")}),function(){if(!b.length)return(0,s.jsx)("div",{children:(0,o.__)("No themes found.","wp-org-portfolio-block-wp")});const e=Number(h)||u,r=b.slice(0,e);return(0,s.jsxs)("div",{className:"was-grid",children:[r.map(e=>{const r=e.screenshot_url||"",n=l(e.name);let i=l(e.description);i&&i.length>100&&(i=i.substring(0,100)+"...");const a=`https://wordpress.org/themes/${e.slug}/`;return(0,s.jsxs)("div",{className:"was-card",children:[r&&(0,s.jsx)("img",{src:r,alt:n}),(0,s.jsxs)("div",{className:"was-card-content",children:[(0,s.jsx)("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:n}),i&&(0,s.jsx)("p",{children:i}),(0,s.jsx)(t.Button,{onClick:()=>window.open(a,"_blank"),className:"was-learn-more",tabIndex:0,children:(0,o.__)("Learn more","wp-org-portfolio-block-wp")})]})]},e.slug)}),r.length<b.length&&(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,s.jsx)(t.Button,{className:"was-load-more-btn",style:{margin:"0 0 8px 0",padding:"5px 20px",fontSize:"1em",borderRadius:4,background:"#f3f3f6",border:"1px solid #bbb",color:"#222",cursor:"pointer"},onClick:()=>y(0,b.length),children:(0,o.__)("Load more","wp-org-portfolio-block-wp")})})]})}()]})]}):(0,s.jsx)("div",{style:{marginTop:"22px",fontSize:"1.08rem",color:"#4a4a4a",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",minHeight:"44px"},children:(0,o.__)("Let's see what magic you've created! Add your WordPress.org username to get started.","wp-org-portfolio-block-wp")})})]})}})})();